import{e as V,u as E,r as k,f,g as U,d as u,c as n,a as t,t as r,h as N,w as m,v as T,n as C,F as B,i as D,b as _,o as a,j as I}from"./index-BKi44uQb.js";const O={id:"todoListPage",class:"bg-half"},M=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),F={class:"todo_sm"},P={href:"#/todo"},j={class:"conatiner todoListPage vhContainer"},R={class:"todoList_Content"},q={class:"inputBox"},G=t("i",{class:"fa"},"+",-1),H=[G],J={key:0,class:"todoList_list"},K={class:"todoList_tab"},Q={class:"todoList_items"},W={class:"todoList_item"},X=["onClick"],Y=["onUpdate:modelValue"],Z={key:1},tt=["onClick"],et=t("i",{class:"fa fa-times"},"📝",-1),ot=[et],st=t("a",null,[t("hr")],-1),nt=["onClick"],at=t("i",{class:"fa fa-times"},"❌",-1),lt=[at],it={key:2,class:"todoList_label"},ct={key:0},dt=["onUpdate:modelValue"],ut={key:3},_t=["onClick"],ht=t("i",{class:"fa fa-times"},"✅",-1),rt=[ht],vt=t("a",null,[t("hr")],-1),pt=["onClick"],kt=t("i",{class:"fa fa-times"},"❎",-1),ft=[kt],mt={class:"todoList_statistics"},Ct={key:0},gt={key:1},yt={key:2},St={key:1},Tt=t("div",null,"目前尚無待辦事項",-1),Lt=[Tt],h="https://todolist-api.hexschool.io",$t={__name:"TodoView",setup(wt){const c=V(),g=E(),i=k([]),v=async()=>{await u.get(h+"/todos",{headers:{Authorization:c.token}}).then(o=>{i.value=o.data.data,i.value.forEach(e=>{e.tmpContent=e.content,e.editState=!1})}).catch(o=>{console.log(o)})},p=k({content:""}),L=()=>{p.value.content!=""&&u.post(h+"/todos",p.value,{headers:{Authorization:c.token}}).then(()=>{v(),p.value.content=""}).catch(o=>{console.log(o)})},w=async o=>{await u.delete(h+"/todos/"+o,{headers:{Authorization:c.token}}).then(()=>{v()}).catch(e=>{console.log(e)})},x=async o=>{await u.put(h+"/todos/"+o.id,{content:o.tmpContent},{headers:{Authorization:c.token}}).then(()=>{v()}).catch(e=>{console.log(e)})},$=()=>{const o=document.cookie.replace(/(?:(?:^|.*;\s*)hexschoolTodo\s*=\s*([^;]*).*$)|^.*$/,"$1");u.post(h+"/users/sign_out",{},{headers:{Authorization:o}}).then(()=>{document.cookie="hexschoolTodo=",setTimeout(()=>{g.push("/")},100)}).catch(e=>{console.log(e)})},b=async o=>{await u.patch(h+"/todos/"+o+"/toggle",{},{headers:{Authorization:c.token}}).then(()=>{v()}).catch(e=>{console.log(e)})},l=k("all"),z=f(()=>{let o=[];return l.value=="all"?i.value:l.value=="done"?(i.value.forEach(e=>{e.status==!0&&o.push(e)}),o):(l.value=="incomplete"&&i.value.forEach(e=>{e.status==!1&&o.push(e)}),o)}),y=f(()=>{let o=0;return i.value.forEach(e=>{e.status==!0&&o++}),o}),S=f(()=>{let o=0;return i.value.forEach(e=>{e.status==!1&&o++}),o});return U(async()=>{if(c.token==""&&g.push("/"),await v(),i.value.length<5){let o=["範例1","範例2","範例3","範例4","範例5"];for(let e of o)console.log(e),await u.post(h+"/todos",{content:e},{headers:{Authorization:c.token}})}}),(o,e)=>(a(),n("div",O,[t("nav",null,[M,t("ul",null,[t("li",F,[t("a",P,[t("span",null,r(N(c).nickname)+" 的代辦",1)])]),t("li",null,[t("a",{onClick:$},"登出")])])]),t("div",j,[t("div",R,[t("div",q,[m(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=s=>p.value.content=s)},null,512),[[T,p.value.content]]),t("a",{onClick:L},H)]),i.value.length>0?(a(),n("div",J,[t("ul",K,[t("li",null,[t("a",{class:C({active:l.value=="all"}),onClick:e[1]||(e[1]=s=>l.value="all")},"全部",2)]),t("li",null,[t("a",{class:C({active:l.value=="incomplete"}),onClick:e[2]||(e[2]=s=>l.value="incomplete")},"待完成",2)]),t("li",null,[t("a",{class:C({active:l.value=="done"}),onClick:e[3]||(e[3]=s=>l.value="done")},"已完成",2)])]),t("div",Q,[t("ul",W,[(a(!0),n(B,null,D(z.value,(s,A)=>(a(),n("li",{key:A},[s.editState==!1?(a(),n("label",{key:0,class:"todoList_label",onClick:d=>b(s.id)},[m(t("input",{class:"todoList_input",type:"checkbox","onUpdate:modelValue":d=>s.status=d},null,8,Y),[[I,s.status]]),t("span",null,r(s.content),1)],8,X)):_("",!0),s.editState==!1?(a(),n("div",Z,[t("a",{onClick:d=>s.editState=!s.editState},ot,8,tt),st,t("a",{onClick:d=>w(s.id)},lt,8,nt)])):_("",!0),s.editState==!0?(a(),n("label",it,[s.editState==!0?(a(),n("span",ct,[m(t("input",{style:{width:"200%"},"onUpdate:modelValue":d=>s.tmpContent=d},null,8,dt),[[T,s.tmpContent]])])):_("",!0)])):_("",!0),s.editState==!0?(a(),n("div",ut,[t("a",{onClick:d=>x(s)},rt,8,_t),vt,t("a",{onClick:d=>s.editState=!s.editState},ft,8,pt)])):_("",!0)]))),128))]),t("div",mt,[l.value=="done"?(a(),n("p",Ct,r(y.value)+" 個已完成項目。",1)):l.value=="incomplete"?(a(),n("p",gt,r(S.value)+" 個未完成項目。",1)):_("",!0),l.value=="all"?(a(),n("p",yt,r(y.value)+" 個已完成項目，"+r(S.value)+" 個未完成項目。",1)):_("",!0)])])])):(a(),n("div",St,Lt))])])]))}};export{$t as default};
